# 🎮 功能说明

全面了解系统的各项功能特性

## 🎭 角色系统

### 角色数据库

#### 角色分类
- **5星角色**：稀有度最高的角色，通常具有独特技能
- **4星角色**：主力角色，平衡的属性和技能
- **元素分类**：火、水、风、雷、草、冰、岩七大元素
- **武器分类**：单手剑、双手剑、长枪、法器、弓箭

#### 角色信息
每个角色包含以下信息：
- **名称**：角色的中文名称
- **稀有度**：4星或5星
- **元素属性**：对应的元素类型
- **武器类型**：使用的武器种类
- **头像**：角色的图标

### 抽取算法

#### 随机算法
- **权重系统**：所有启用角色具有相等权重
- **避重机制**：根据BP模式避免重复抽取
- **公平性保证**：确保每个角色被抽中的概率相等

#### BP算法详解

**全局BP算法**：
```
可用角色池 = 全部启用角色 - 全局已使用角色 - 个人屏蔽角色
```

**个人BP算法**：
```
可用角色池 = 全部启用角色 - 个人已使用角色 - 个人屏蔽角色
```

**无BP算法**：
```
可用角色池 = 全部启用角色 - 个人屏蔽角色
```

## 📋 事件系统

### 个人事件机制

#### 事件类型
- **挑战类事件**：增加游戏难度的挑战任务
- **限制类事件**：对游戏方式的特殊限制
- **互动类事件**：需要玩家间协作的事件
- **随机类事件**：完全随机的特殊情况

#### 动态事件处理
某些事件具有动态内容生成功能：

**示例：方位车事件**
- 事件模板：`${AA}最高的角色站${BB}`
- AA池：`["等级", "命座", "攻击", "生命", "防御", "精通"]`
- BB池：`["上", "下", "左", "右", "左上", "左下", "右上", "右下"]`
- 生成结果：如"攻击最高的角色站右上"

### 团队事件机制

#### 投票系统
1. **候选生成**：从启用团队事件中随机选择3个
2. **投票界面**：以卡片形式展示候选事件
3. **投票统计**：实时统计所有玩家的投票
4. **结果确定**：选择得票最多的事件

#### 多人同步
- **状态广播**：每次投票都会广播给所有玩家
- **结果同步**：最终结果确保所有玩家一致
- **UI更新**：投票状态实时反映在界面上

### 重抽次数系统

#### 基础机制
- **初始值**：游戏开始时默认为3次
- **手动调整**：可通过+/-按钮手动调整
- **使用规则**：每次抽取事件时检查是否有重抽次数

#### 概率系统
每次抽取事件时有概率获得额外重抽次数：
- **基础概率**：5%
- **结果随机**：+1或-1次重抽机会
- **平衡机制**：连续两次-1后，下次必为+1
- **概率递增**：未触发时概率累加5%

## 🔧 设置系统

### 角色管理功能

#### 批量操作
- **全选/全不选**：快速启用或禁用所有角色
- **按类别选择**：按元素、武器、稀有度批量操作
- **反选功能**：反转当前选择状态

#### 实时筛选
```javascript
筛选逻辑 = {
  元素筛选: 选中元素.includes(角色.元素),
  武器筛选: 选中武器.includes(角色.武器),
  稀有度筛选: 选中稀有度.includes(角色.稀有度),
  搜索筛选: 角色.名称.includes(搜索关键词)
}
```

#### 状态持久化
- **本地存储**：使用localStorage保存设置
- **自动恢复**：页面刷新后自动恢复之前的设置
- **跨会话**：设置在不同浏览器会话间保持

### 事件管理功能

#### 表格操作
- **复选框控制**：通过复选框启用/禁用事件
- **内容预览**：在表格中直接查看事件内容
- **搜索功能**：快速定位特定事件

#### 分类管理
- **个人事件表格**：管理所有个人事件
- **团队事件表格**：管理所有团队事件
- **独立配置**：两类事件可独立启用/禁用

### 历史记录系统

#### 角色历史
- **抽取记录**：记录每次角色抽取的结果
- **时间戳**：精确到秒的时间记录
- **玩家信息**：在多人游戏中记录操作玩家

#### 事件历史
- **事件详情**：记录具体的事件内容
- **轮次信息**：区分不同轮次的事件
- **投票记录**：团队事件的投票过程

## 🌐 多人游戏架构

### 服务器通信

#### WebSocket连接
- **实时通信**：建立持久化连接确保实时性
- **心跳机制**：定期发送心跳包维持连接
- **重连机制**：断线后自动尝试重连

#### 消息协议
```javascript
消息格式 = {
  type: "消息类型",
  roomId: "房间ID", 
  playerId: "玩家ID",
  data: "具体数据"
}
```

#### 常用消息类型
- `join-room`：加入房间
- `character-draw`：角色抽取
- `mission-draw`：事件抽取
- `vote-hard-mission`：团队事件投票
- `sync-state`：状态同步

### 房间管理

#### 房间生命周期
1. **创建阶段**：主持人创建房间，分配房间ID
2. **加入阶段**：其他玩家通过ID加入房间
3. **游戏阶段**：进行正常的游戏操作
4. **结束阶段**：主持人离开或手动结束

#### 状态同步策略
- **增量同步**：只同步发生变化的数据
- **完整同步**：新玩家加入时进行完整状态同步
- **冲突解决**：以主持人状态为准解决冲突

## 📱 响应式设计

### 屏幕适配

#### 断点设计
- **大屏幕**：>1200px，完整功能显示
- **中等屏幕**：768px-1200px，优化布局
- **小屏幕**：<768px，移动端适配

#### 布局调整
```css
大屏幕布局: 侧边栏 + 主内容 + 目录导航
中等屏幕布局: 折叠侧边栏 + 主内容
小屏幕布局: 汉堡菜单 + 主内容
```

### 交互优化

#### 触摸友好
- **按钮尺寸**：保证最小44px触摸目标
- **间距设计**：合理的元素间距避免误触
- **手势支持**：支持滑动、点击等手势操作

#### 性能优化
- **懒加载**：大型资源按需加载
- **缓存策略**：合理利用浏览器缓存
- **动画优化**：使用CSS3硬件加速

## 🔍 搜索与筛选

### 智能搜索

#### 搜索算法
- **模糊匹配**：支持部分名称匹配
- **拼音搜索**：支持拼音首字母搜索
- **实时过滤**：输入即时显示结果

#### 搜索范围
- **角色搜索**：在角色管理中搜索角色名称
- **事件搜索**：在事件管理中搜索事件内容
- **文档搜索**：在使用文档中搜索相关内容

### 高级筛选

#### 多条件筛选
```javascript
筛选条件 = {
  元素: ["火", "水"],
  武器: ["单手剑"],
  稀有度: ["5星"],
  搜索词: "角色名称"
}
```

#### 筛选联动
- **条件组合**：多个筛选条件之间为AND关系
- **动态更新**：筛选条件变化时实时更新结果
- **状态保持**：筛选状态在页面刷新后保持

## 🎨 用户界面

### 设计语言

#### 视觉风格
- **现代扁平**：简洁的扁平化设计风格
- **毛玻璃效果**：使用backdrop-filter实现现代感
- **渐变配色**：品牌色彩的渐变应用
- **圆角设计**：统一的圆角半径增加亲和力

#### 动效设计
- **过渡动画**：0.3s的标准过渡时间
- **缓动函数**：ease-in-out的自然缓动
- **加载动画**：友好的加载状态提示
- **微交互**：hover、active状态的细微反馈

### 可访问性

#### 键盘导航
- **Tab顺序**：合理的Tab键导航顺序
- **焦点指示**：清晰的焦点状态指示
- **快捷键**：常用功能的快捷键支持

#### 屏幕阅读器
- **语义化HTML**：使用正确的HTML语义标签
- **ARIA属性**：适当的ARIA属性增强可访问性
- **文本描述**：为图片和操作提供文本描述

---

这些功能特性共同构成了一个完整、强大且用户友好的角色和事件抽取系统！ 🚀
